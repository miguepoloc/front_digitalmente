"use strict";(self.webpackChunkfront_digitalmente=self.webpackChunkfront_digitalmente||[]).push([[270],{46193:function(e,n,t){t.r(n),t.d(n,{default:function(){return k}});var s=t(72791),a=(t(43084),t(83562),t(61998),t(54774)),r=t(71762),i=t(76098),o=t(74165),c=t(15861),l=t(70885),u=t(28894),d=(t(7237),t(74218)),m=t(80184),h=function(e){var n=e.question,t=e.name,s=e.index,a=e.color,r=e.selectOption,i=e.answerSelected;return(0,m.jsxs)("div",{className:"mb-4  col-12  col-lg-6",children:[(0,m.jsx)("div",{className:"card-header  d-flex align-items-center",style:{backgroundColor:a},children:(0,m.jsx)("h5",{className:"my-0 font-weight-normal text-white  ",children:s+1+". "+n.question})}),(0,m.jsx)("div",{className:"border shadow w-100 card-body float-left pt-0",children:(0,m.jsx)("div",{className:"float-left d-flex flex-column",children:n.answer.map((function(e,a){return(0,m.jsx)(d.Z,{_name:"".concat(t,"_").concat(s),_text_answer:e.answer,_id:"answer_".concat(e.id_answer),handleClickAnswer:function(){return r(n.id_question,e.id_answer)},id_answerDB:e.id_answer,answerSelected:i,index:s},"".concat(e.id_answer))}))})})]})},f=function(e){var n=e.questions,t=e.name,s=e.color,a=e.selectOption;return(0,m.jsx)("div",{className:"mx-4 my-4 ",children:(0,m.jsx)("div",{className:"row",children:n.map((function(e,n){return(0,m.jsx)(h,{name:t,question:e,index:n,color:s,selectOption:a,answerSelected:e.selected},e.id_question)}))})})},x=function(e){var n=e.survey,t=e.selectOption;return document.documentElement.style.setProperty("--colorCheck",n.color),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"callout mb-4",style:{borderLeftColor:n.color},children:[(0,m.jsx)("h5",{style:{color:n.color},children:n.name}),(0,m.jsx)("p",{children:n.desc})]}),(0,m.jsx)(f,{questions:n.questions,name:n.name,color:n.color,selectOption:t},n.name+n.id_survey)]})},v=t(36845),p=t(70812),j=t(17822),g=t(5946),y=t(47962),b=t(80041),w=t(84920),S=t(2390),_=function(){(0,p.hW)("Ups...","Parece que alguna pregunta de esta encuesta ha quedado sin responder. por favor, asegurate de que <b> todas </b> las preguntas tengan respuesta")},N=function(){var e=(0,s.useContext)(i.V).authState,n=e.userInfo,t=e.token,a=n.id,r=n.sexo.id,d=(0,s.useState)(new u.J(null,a,r,!1)),h=(0,l.Z)(d,2),f=h[0],N=h[1],k=(0,s.useState)(!0),Z=(0,l.Z)(k,2),q=Z[0],C=Z[1],O=(0,s.useState)(!1),A=(0,l.Z)(O,2),I=A[0],F=A[1],D=(0,s.useState)(!1),E=(0,l.Z)(D,2),T=E[0],U=E[1],J=(0,s.useState)(!1),L=(0,l.Z)(J,2),P=L[0],z=L[1],V=(0,s.useState)(null),R=(0,l.Z)(V,2),B=R[0],H=R[1],M=function(){var e;try{return(e=w.l.recuperarDatosLocalStorage(a))?(0,p.Zl)("\xa1En horabuena!","\xa1He podido recuperar tus respuestas! Intenta terminar de responder las preguntas. Si tienes alguna falla de conexi\xf3n, solo podre mantenerlas guardadas temporalmente hasta 48 horas. Una vez termines el m\xf3dulo y env\xedes tus respuestas completas, se guardaran definitivamente.",void 0,void 0):(0,p.hi)("Ups...","\xa1Lo siento! Han pasado mas de 48 horas desde la ultima vez que intentaste responder las preguntas. Int\xe9ntalo nuevamente.<br/> Recuerda que si tienes alguna falla de conexi\xf3n, solo podre mantenerlas guardadas temporalmente hasta 48 horas. Una vez termines el m\xf3dulo y env\xedes tus respuestas completas, se guardaran definitivamente",void 0,void 0),e}catch(I){return null}};(0,s.useEffect)((function(){var e=function(){var e=(0,c.Z)((0,o.Z)().mark((function e(){var n,s;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,j.Tr)(t);case 2:if(n=e.sent)try{s=M(),N(s?new u.J(n,a,r).loadDataLocalStorage(s.datosSurveys):new u.J(n,a,r)),C(!1)}catch(i){C(!1),F(!0)}else C(!1),F(!0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]),(0,s.useEffect)((function(){f.arrSurvey&&Q()}),[T]);var Q=function(){n.is_staff?m.Fragment:S.Z.scroll("startSurvey",!0)},W=function(){var e=(0,c.Z)((0,o.Z)().mark((function e(){var n,t,s=arguments;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!(s.length>0&&void 0!==s[0])||s[0],!f.isAllQuestionsSelected()&&n&&_(),(t=n?f.nextSurvey():f.prevSurvey())&&(N(t),U(!T));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Y=function(){for(var e=f.getLengthJsonSurvey(),n=f.generateJsonToSend(),t=[],s=0;s<e;s++)t.push(G(n,s));return t},G=function(e,n){var t=Object.keys(e)[n];return{id_usuario:""+a,id_encuesta:t,respuestas:e[t]}},K=function(){var e=(0,c.Z)((0,o.Z)().mark((function e(){var s,r,i,c;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!f.isAllSurveysAnswered()){e.next=13;break}return z((function(){return!0})),(0,p.V)(void 0,"Tus respuestas estan siendo enviadas y procesadas <b>Espera un momento</b>"),s=Y(),r=6e4*(new Date).getTimezoneOffset(),i=new Date(Date.now()-r).toISOString().slice(0,-1),s=s.map((function(e){return e.fecha=i,e})),e.next=9,(0,j.OV)(s,t);case 9:e.sent?((0,p.Zl)(void 0,"\xa1Enhorabuena! \xa1Tus respuestas han sido procesadas y <b>he tra\xeddo los resultados</b>!").then((function(){H(f.results())})),c={autoevaluativo:2,usuario:n.id},(0,j.Fo)(n.id,c,t),w.l.eliminarDatos(a),window.localStorage.removeItem("data_survey_local")):(0,p.hi)(),e.next=14;break;case 13:_();case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("section",{id:"startSurvey",className:"container",children:q?(0,m.jsx)(y.g,{}):(0,m.jsx)(m.Fragment,{children:I?(0,m.jsx)(g.B,{text:"Uhm... Parece que ha ocurrido un error al obtener las pruebas diagn\xf3sticas."}):(0,m.jsx)(m.Fragment,{children:null!==B?(0,m.jsx)(b.Y,{objResultados:B}):f.arrSurvey?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(x,{survey:f.jsonSurvey[f.indiceActual],selectOption:function(e,n){f.selectOption(e,n),N(f)}}),(0,m.jsxs)("div",{className:"d-flex justify-content-between mx-4",children:[(0,m.jsx)("div",{id:"backSurvey",children:(0,m.jsx)("button",{type:"button",className:"btn btn-outline-secondary",onClick:function(){return W(!1)},children:"Anterior"})}),(0,m.jsx)("div",{id:"surveysPage",className:"d-block p-2",children:(0,m.jsxs)("p",{children:[f.indiceActual+1," de ",f.IndiceMaximo+1]})}),f.indiceActual<f.IndiceMaximo?(0,m.jsx)("div",{id:"nextSurvey",children:(0,m.jsx)("button",{type:"button",className:"btn btn-outline-primary",onClick:W,children:"Siguiente"})}):(0,m.jsx)("div",{id:"SendSurvey",children:(0,m.jsx)("button",{id:"btnSendSurvey",type:"button",className:"btn btn-info text-white",onClick:K,disabled:P,children:"Enviar"})})]}),n.is_staff?(0,m.jsx)("div",{className:"d-flex justify-content-center mx-4",children:(0,m.jsx)("div",{children:(0,m.jsx)("button",{type:"button",className:"btn btn-danger text-center",onClick:function(){return f.selectAllOptionRandom(),void f.markAllQuestionSelected()},children:"Test: llenar encuesta"})})}):null]}):(0,m.jsx)("div",{className:"d-flex flex-column justify-content-center align-items-center",style:{height:"80vh"},children:(0,m.jsxs)("div",{className:"d-flex flex-column justify-content-center align-items-center",children:[(0,m.jsx)("img",{src:v,width:"307",height:"307",alt:"ganso_pensando"}),(0,m.jsx)("h5",{className:"my-4 text-center",children:"Uhm... Parece que no tengo pruebas diagn\xf3sticas."})]})})})})})})},k=function(){var e=(0,s.useContext)(i.V).authState.userInfo;return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("div",{className:"g-sidenav-show bg-gray-100 ",children:(0,m.jsxs)("main",{className:"main-content position-relative h-100 border-radius-lg ",children:[(0,m.jsx)(a.Z,{userInfo:e}),(0,m.jsxs)("div",{className:"container-fluid py-4",children:[(0,m.jsx)("div",{children:(0,m.jsx)(N,{})}),(0,m.jsx)("hr",{}),(0,m.jsx)(r.Z,{})]})]})})})}},61998:function(){}}]);
//# sourceMappingURL=270.1d016770.chunk.js.map